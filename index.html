<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Puzzle Drag & Drop</title>
<style>
  body {
    font-family: sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    min-height: 100vh;
    background: #111;
    color: #fff;
    padding: 20px;
  }
  h2 { text-align: center; margin-bottom: 20px; }
  #puzzle, #slots {
    display: flex;
    flex-wrap: wrap;
    max-width: 400px;
    margin-bottom: 20px;
    justify-content: center;
  }
  .piece, .slot {
    background: #444;
    margin: 5px;
    padding: 10px 14px;
    border-radius: 8px;
    cursor: grab;
    user-select: none;
    text-align: center;
    min-width: 80px;
  }
  .slot { 
    background: #222; 
    cursor: default; 
    min-height: 40px; 
    flex: 1; 
    transition: background 0.3s;
  }
  .correct { background: #2e7d32 !important; color: #fff; }
  .wrong { background: #c62828 !important; color: #fff; }
  #output { 
    margin-top: 20px; 
    white-space: pre-line; 
    text-align: center; 
    opacity: 0; 
    transition: opacity 0.6s; 
  }
</style>
</head>
<body>

<h2>Trascina i pezzi per ricomporre il testo!</h2>
<div id="slots"></div>
<div id="puzzle"></div>
<div id="output"></div>

<script>
const text = `There's nothing like the way you get me high
You got a heart from heaven
But you're burning like hell`;

const fragments = [
  "There's nothing like the way you get me high",
  "You got a heart from heaven",
  "But you're burning like hell"
];

// mischiamo i pezzi
const shuffled = [...fragments].sort(() => Math.random() - 0.5);

const puzzleDiv = document.getElementById('puzzle');
const slotsDiv = document.getElementById('slots');
const outputDiv = document.getElementById('output');

let draggedPiece = null;

// crea slot vuoti
fragments.forEach((_, index) => {
  const slot = document.createElement('div');
  slot.className = 'slot';
  slot.dataset.index = index; // posizione corretta
  slot.ondragover = e => e.preventDefault();
  slot.ondrop = e => {
    if (draggedPiece) {
      slot.textContent = draggedPiece.textContent;

      if (draggedPiece.textContent === fragments[index]) {
        slot.classList.add("correct");
        slot.classList.remove("wrong");
        draggedPiece.style.display = 'none'; // pezzo usato
      } else {
        slot.classList.add("wrong");
        setTimeout(() => {
          slot.textContent = ""; 
          slot.classList.remove("wrong");
        }, 800); // dopo 0.8s si resetta
      }
      checkCompletion();
    }
  };
  slotsDiv.appendChild(slot);
});

// crea pezzi trascinabili
shuffled.forEach(piece => {
  const div = document.createElement('div');
  div.className = 'piece';
  div.textContent = piece;
  div.draggable = true;
  div.ondragstart = () => { draggedPiece = div; };
  puzzleDiv.appendChild(div);
});

function checkCompletion() {
  const slotTexts = Array.from(slotsDiv.children).map(s => s.textContent || '');
  if (slotTexts.join(' ') === fragments.join(' ')) {
    outputDiv.textContent = text;
    outputDiv.style.opacity = 1;
  }
}
</script>

</body>
</html>
